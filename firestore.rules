rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Waitlist â€” anyone can submit their email, only admins can read/delete
    match /waitlist/{emailId} {
      allow create, update: if request.resource.data.keys().hasAll(['email', 'timestamp'])
                            && request.resource.data.email is string
                            && request.resource.data.email.size() > 0
                            && request.resource.data.email.size() < 255;
      allow read, delete: if false;
    }

    // Default deny everything else
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
